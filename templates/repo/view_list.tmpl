<table id="repo-files-table" class="ui table">
  <thead>
    <tr>
      <th colspan="2">
        <span>
          {{if .LastCommitUser}}
          <img class="ui avatar image img-12" src="{{.LastCommitUser.AvatarLink}}" />
          <a href="{{AppSubUrl}}/{{.LastCommitUser.Name}}"><strong>{{.LastCommit.Author.Name}}</strong></a>
          {{else}}
          <img class="ui avatar image img-12" src="{{AvatarLink .LastCommit.Author.Email}}" />
          <strong>{{.LastCommit.Author.Name}}</strong>
          {{end}}
        </span>
        <a rel="nofollow" class="ui sha label" href="{{.RepoLink}}/commit/{{.LastCommit.ID}}" rel="nofollow">{{ShortSha .LastCommit.ID.String}}</a>
        <span class="text truncate grey">{{RenderCommitMessage .LastCommit.Summary .RepoLink}}</span>
      </th>
      <th class="text grey right age four wide">{{TimeSince .LastCommit.Author.When $.Lang}}</th>
    </tr>
  </thead>
  <tbody>
    {{if .HasParentPath}}
    <tr class="has-parent">
      <td colspan="3"><i class="icon octicon octicon-mail-reply"></i><a href="{{EscapePound .BranchLink}}{{.ParentPath}}">..</a></td>
    </tr>
    {{end}}
    {{range $item := .Files}}
      {{$entry := index $item 0}}
      {{$commit := index $item 1}}
      <tr>
        {{if $entry.IsSubModule}}
        <td class="four wide">
          <span class="icon octicon octicon-file-submodule"></span>
          {{if $commit.RefUrl}}
          <a href="{{$commit.RefUrl}}" class="text truncate">{{$entry.Name}}</a> @ <a href="{{$commit.RefUrl}}/commit/{{$commit.RefId}}">{{ShortSha $commit.RefId}}</a>
          {{else}}
          {{$entry.Name}} @ {{ShortSha $commit.RefId}}
          {{end}}
        </td>
        {{else}}
        <td class="name four wide">
          <span class="icon octicon octicon-file-{{if or $entry.IsDir}}directory{{else}}text{{end}}"></span>
          <a href="{{EscapePound $.BranchLink}}/{{EscapePound $.TreePath}}{{EscapePound $entry.Name}}" class="text truncate">{{$entry.Name}}</a>
        </td>
        {{end}}
        <td class="message collapsing eight wide">
          <a rel="nofollow" class="ui sha label" href="{{AppSubUrl}}/{{$.Username}}/{{$.Reponame}}/commit/{{$commit.ID}}">{{ShortSha $commit.ID.String}}</a>
          <span class="text truncate">{{RenderCommitMessage $commit.Summary $.RepoLink}}</span>
        </td>
        <td class="text grey right age four wide">{{TimeSince $commit.Committer.When $.Lang}}</td>
      </tr>
    {{end}}
  </tbody>
</table>
{{if .ReadmeExist}}
  {{template "repo/view_file" .}}
{{end}}
